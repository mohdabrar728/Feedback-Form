{% extends 'base.html' %}
{% load static %}
{% block container %}
<div class="container">
    <br><br><br><br>
     <form method="post" action="/formdata">
        {% csrf_token %}
        <div class="input-group mb-3">
          {{dropform|safe}}
            <div class="input-group-append">
            <input type="submit" value="show data" class="btn btn-secondary">
          </div>
        </div>
     </form>
</div>
{% if data %}
        <div class="overflow-scroll">
            <table class="table table-bordered" id="table">
                <tr class="table-success">
                    <th>S.No</th>
                    {% if request.session.on %}
                    <th>Mail ID's</th>
                    {% endif %}
                    {% for i in data1|slice:"1:" %}
                    <th>{{i}}</th>
                    {% endfor %}
                </tr>
            {% for i in data %}
            <tr>
                {% for j in i %}
                <td>{{j}}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
        </div>
<br>
 <center>
     <button onclick="ExportToExcel('xlsx')" class="btn btn-success">Export table to excel</button>
 </center>

            <script>

                function ExportToExcel(type, fn, dl) {
                    var elt = document.getElementById('table');
                    var wb = XLSX.utils.table_to_book(elt, { sheet: "sheet1" });
                    return dl ?
                        XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }) :
                        XLSX.writeFile(wb, fn || ('{{request.session.name}}.' + (type || 'xlsx')));
                }

            </script>
    <div class="col-6"></div>
</div>
{% endif %}
{% endblock %}